{
    "name": "idrm-specify",
    "version": "2.1.0",
    "description": "生成业务需求规范，遵循IDRM Spec v2.1.0 - 聚焦What和Why，不涉及技术实现",
    "category": "requirements",
    "spec_reference": "sdd_doc/spec/workflow/phase1-specify.md",
    "guide_reference": "sdd_doc/ai-guide-v2/03-workflow/phase1-详细操作.md",
    "inputs": {
        "feature_description": {
            "type": "string",
            "required": true,
            "description": "功能描述（简短说明要做什么）"
        },
        "context_files": {
            "type": "array",
            "required": false,
            "description": "相关上下文文件路径"
        }
    },
    "outputs": {
        "requirements_file": {
            "type": "file",
            "path": "specs/features/{feature_name}/requirements.md",
            "template": "phase1_requirements_template"
        }
    },
    "prompt_template": {
        "system": "你是一个需求分析专家，遵循IDRM Spec v2.1.0规范。核心原则：'Focus on the what and why, not the tech stack'。只关注业务需求，不涉及技术实现细节。",
        "user": "为以下功能生成Phase 1 Requirements：\n{{feature_description}}\n\n请严格按照以下结构生成：\n\n## Overview\n（2-3句话概述）\n\n## User Stories\nAS a {角色}\nI WANT {功能}\nSO THAT {价值/目标}\n\n（至少3个User Stories）\n\n## Acceptance Criteria (EARS Notation)\nWHEN {触发条件/事件}\nTHE SYSTEM SHALL {期望行为}\n\n要求：\n- 覆盖正常流程（Happy Path）\n- 覆盖所有参数验证情况\n- 覆盖业务规则违反情况\n- 覆盖边界情况\n\n## Business Rules\n业务规则和约束（不涉及技术实现）\n包含：\n- 业务流程规则\n- 数据约束（唯一性、范围、层级等）\n- 业务逻辑限制\n\n不包含：\n- 技术架构（Handler/Logic/Model）\n- ORM选择\n- 编码规范\n- 数据库表结构\n\n## Data Considerations\n需要持久化的数据描述（不是SQL表结构）：\n- 需要存储的信息\n- 数据关系（用文字描述）\n\n## Open Questions\n待澄清的问题\n\n---\n\n参考规范：\n@sdd_doc/spec/workflow/phase1-specify.md\n@sdd_doc/ai-guide-v2/03-workflow/phase1-详细操作.md",
        "examples": [
            {
                "feature": "资源分类管理",
                "requirements_snippet": "## User Story: 创建资源分类\nAS a 数据管理员\nI WANT 创建新的资源分类\nSO THAT 我可以更好地组织数据资源\n\n## Business Rules\n- 分类最多支持3层\n- 分类名称在同一父分类下必须唯一\n- 删除分类前必须检查是否有子分类"
            }
        ]
    },
    "validation_rules": [
        {
            "rule": "must_have_user_stories",
            "description": "必须包含至少3个User Stories",
            "check": "文档中包含'User Stories'章节且有AS/I WANT/SO THAT格式"
        },
        {
            "rule": "must_use_ears",
            "description": "必须使用EARS notation",
            "check": "文档中包含'Acceptance Criteria'且使用WHEN/THE SYSTEM SHALL格式"
        },
        {
            "rule": "must_have_business_rules",
            "description": "必须定义Business Rules",
            "check": "文档中包含'Business Rules'章节"
        },
        {
            "rule": "no_technical_constraints",
            "description": "不能包含技术约束",
            "check": "文档中不包含'Technical Constraints'、SQL语句、架构图等技术实现"
        },
        {
            "rule": "no_data_model",
            "description": "不能包含数据库表结构",
            "check": "文档中不包含CREATE TABLE、Go结构体定义等"
        }
    ],
    "quality_gate": "Gate 1",
    "next_phase": {
        "phase": "Phase 2: Design",
        "skill": "idrm-design",
        "input": "本skill输出的requirements.md"
    }
}