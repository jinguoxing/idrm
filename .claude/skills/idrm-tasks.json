{
    "name": "idrm-tasks",
    "version": "2.1.0",
    "description": "将设计方案拆分为可执行的小任务，每个<50行",
    "category": "planning",
    "spec_reference": "private_doc/spec/workflow/phase3-tasks.md",
    "guide_reference": "private_doc/ai-guide-v2/03-workflow/phase3-详细操作.md",
    "inputs": {
        "design_file": {
            "type": "file",
            "required": true,
            "description": "Phase 2生成的design.md文件路径"
        }
    },
    "outputs": {
        "tasks_file": {
            "type": "file",
            "path": "specs/features/{feature_name}/tasks.md",
            "template": "phase3_tasks_template"
        }
    },
    "prompt_template": {
        "system": "你是一个任务规划专家，将技术设计拆分为可执行的小任务。每个任务必须<50行代码。",
        "user": "基于以下技术设计：\n@{{design_file}}\n\n生成Phase 3 Tasks，严格按照以下原则：\n\n## 任务拆分原则\n\n1. **单一职责**：每个task只做一件事\n2. **小任务**：每个task ≤50行代码\n3. **自下而上**：Model → Logic → Handler顺序\n4. **明确依赖**：每个task标注依赖的其他tasks\n\n## Tasks模板\n\n### Task {编号}: {任务名称}\n\n**Status**: ⏸️ Not Started\n\n**Priority**: P0 / P1 / P2\n\n**Estimated Lines**: {预估行数}\n\n**Depends On**: Task {依赖编号}\n\n**Files**:\n- {文件路径}\n\n**Description**:\n{1-2句话描述}\n\n**Acceptance Criteria**:\n- [ ] {验收标准1}\n- [ ] {验收标准2}\n\n**Implementation Notes**:\n（可选的实现提示）\n\n---\n\n## 任务组织\n\n按层级组织tasks：\n\n### Model层 (Tasks 1-N)\n- Task 1: 创建Model接口和类型\n- Task 2: 实现GORM DAO\n- Task 3: 实现SQLx Model\n- Task 4: 实现Factory\n\n### Logic层 (Tasks N+1-M)\n- 每个业务方法一个task\n\n### Handler层 (Tasks M+1-X)\n- 每个HTTP接口一个task\n\n### 测试 (Task Z)\n- 综合测试任务\n\n## 任务依赖图\n```mermaid\ngraph TD\n    T1[Task 1] --> T2[Task 2]\n    ...\n```\n\n---\n\n参考规范：\n@private_doc/spec/workflow/phase3-tasks.md\n@private_doc/ai-guide-v2/03-workflow/phase3-详细操作.md"
    },
    "validation_rules": [
        {
            "rule": "max_50_lines",
            "description": "每个任务必须≤50行",
            "check": "所有task的Estimated Lines字段≤50"
        },
        {
            "rule": "clear_dependencies",
            "description": "依赖关系必须明确",
            "check": "每个task有'Depends On'字段（除了第一个）"
        },
        {
            "rule": "bottom_up_order",
            "description": "必须自下而上顺序",
            "check": "Model层tasks在前，Handler层tasks在后"
        },
        {
            "rule": "acceptance_criteria",
            "description": "必须有验收标准",
            "check": "每个task有Acceptance Criteria清单"
        }
    ],
    "quality_gate": "Gate 3",
    "next_phase": {
        "phase": "Phase 4: Implement",
        "skill": "idrm-implement",
        "input": "本skill输出的tasks.md"
    }
}